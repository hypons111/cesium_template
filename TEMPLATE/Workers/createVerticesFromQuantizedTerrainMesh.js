/**
 * @license
 * Cesium - https://github.com/CesiumGS/cesium
 * Version 1.115
 *
 * Copyright 2011-2022 Cesium Contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Columbus View (Pat. Pend.)
 *
 * Portions licensed separately.
 * See https://github.com/CesiumGS/cesium/blob/main/LICENSE.md for full licensing details.
 */
import{a as Ct,b as vt}from"./chunk-HCYU7WEB.js";import{a as Mt}from"./chunk-R7GRRUJS.js";import{a as z}from"./chunk-Q3ITDG7Y.js";import"./chunk-FZIR7YHL.js";import{a as Wt}from"./chunk-U54QHQ4X.js";import{a as X}from"./chunk-SPMRTIBU.js";import{h as At}from"./chunk-LYPPBP4Q.js";import"./chunk-PCFGFNNQ.js";import"./chunk-V2SDNSQR.js";import{b as U,c as bt}from"./chunk-S7TTFAYA.js";import"./chunk-TLYHKSDJ.js";import{a as P,b as wt,c as lt,d as pt}from"./chunk-PYVDHCDQ.js";import{a as f}from"./chunk-JMWWNZHX.js";import"./chunk-DNO4OWAM.js";import"./chunk-XDVDNOI4.js";import"./chunk-Z3SYNMQT.js";import{a as m}from"./chunk-4KGDZUZQ.js";import{e as w}from"./chunk-F3TINEFX.js";function T(){m.throwInstantiationError()}Object.defineProperties(T.prototype,{errorEvent:{get:m.throwInstantiationError},credit:{get:m.throwInstantiationError},tilingScheme:{get:m.throwInstantiationError},hasWaterMask:{get:m.throwInstantiationError},hasVertexNormals:{get:m.throwInstantiationError},availability:{get:m.throwInstantiationError}});var Ot=[];T.getRegularGridIndices=function(t,e){if(t*e>=f.FOUR_GIGABYTES)throw new m("The total number of vertices (width * height) must be less than 4,294,967,296.");let r=Ot[t];w(r)||(Ot[t]=r=[]);let n=r[e];return w(n)||(n=t*e<f.SIXTY_FOUR_KILOBYTES?r[e]=new Uint16Array((t-1)*(e-1)*6):r[e]=new Uint32Array((t-1)*(e-1)*6),Pt(t,e,n,0)),n};var Gt=[];T.getRegularGridIndicesAndEdgeIndices=function(t,e){if(t*e>=f.FOUR_GIGABYTES)throw new m("The total number of vertices (width * height) must be less than 4,294,967,296.");let r=Gt[t];w(r)||(Gt[t]=r=[]);let n=r[e];if(!w(n)){let i=T.getRegularGridIndices(t,e),o=Lt(t,e),s=o.westIndicesSouthToNorth,a=o.southIndicesEastToWest,h=o.eastIndicesNorthToSouth,u=o.northIndicesWestToEast;n=r[e]={indices:i,westIndicesSouthToNorth:s,southIndicesEastToWest:a,eastIndicesNorthToSouth:h,northIndicesWestToEast:u}}return n};var kt=[];function Lt(t,e){let r,n=new Array(e),i=new Array(t),o=new Array(e),s=new Array(t);for(r=0;r<t;++r)s[r]=r,i[r]=t*e-1-r;for(r=0;r<e;++r)o[r]=(r+1)*t-1,n[r]=(e-r-1)*t;return{westIndicesSouthToNorth:n,southIndicesEastToWest:i,eastIndicesNorthToSouth:o,northIndicesWestToEast:s}}function Pt(t,e,r,n){let i=0;for(let o=0;o<e-1;++o){for(let e=0;e<t-1;++e){let e=i,o=e+t,s=o+1,a=e+1;r[n++]=e,r[n++]=o,r[n++]=a,r[n++]=a,r[n++]=o,r[n++]=s,++i}++i}}function Z(t,e,r,n){let i=t[0],o=t.length;for(let s=1;s<o;++s){let o=t[s];r[n++]=i,r[n++]=o,r[n++]=e,r[n++]=e,r[n++]=o,r[n++]=e+1,i=o,++e}return n}T.getRegularGridAndSkirtIndicesAndEdgeIndices=function(t,e){if(t*e>=f.FOUR_GIGABYTES)throw new m("The total number of vertices (width * height) must be less than 4,294,967,296.");let r=kt[t];w(r)||(kt[t]=r=[]);let n=r[e];if(!w(n)){let i=t*e,o=(t-1)*(e-1)*6,s=2*t+2*e,a=6*Math.max(0,s-4),h=i+s,u=o+a,c=Lt(t,e),l=c.westIndicesSouthToNorth,d=c.southIndicesEastToWest,m=c.eastIndicesNorthToSouth,I=c.northIndicesWestToEast,g=X.createTypedArray(h,u);Pt(t,e,g,0),T.addSkirtIndices(l,d,m,I,i,g,o),n=r[e]={indices:g,westIndicesSouthToNorth:l,southIndicesEastToWest:d,eastIndicesNorthToSouth:m,northIndicesWestToEast:I,indexCountWithoutSkirts:o}}return n},T.addSkirtIndices=function(t,e,r,n,i,o,s){let a=i;s=Z(t,a,o,s),a+=t.length,s=Z(e,a,o,s),a+=e.length,s=Z(r,a,o,s),a+=r.length,Z(n,a,o,s)},T.heightmapTerrainQuality=.25,T.getEstimatedLevelZeroGeometricErrorForAHeightmap=function(t,e,r){return 2*t.maximumRadius*Math.PI*T.heightmapTerrainQuality/(e*r)},T.prototype.requestTileGeometry=m.throwInstantiationError,T.prototype.getLevelMaximumGeometricError=m.throwInstantiationError,T.prototype.getTileDataAvailable=m.throwInstantiationError,T.prototype.loadTileDataAvailability=m.throwInstantiationError;var Vt=T,ht=32767,D=new P,Xt=new P,Zt=new P,u=new wt,Y=new lt;function Jt(t,e){let r,n,i=t.quantizedVertices,o=i.length/3,s=t.octEncodedNormals,a=t.westIndices.length+t.eastIndices.length+t.southIndices.length+t.northIndices.length,h=t.includeWebMercatorT,c=t.exaggeration,l=t.exaggerationRelativeHeight,d=1!==c,m=bt.clone(t.rectangle),I=m.west,T=m.south,g=m.east,N=m.north,p=pt.clone(t.ellipsoid),E=t.minimumHeight,S=t.maximumHeight,y=t.relativeToCenter,A=At.eastNorthUpToFixedFrame(y,p),b=U.inverseTransformation(A,new U);h&&(r=z.geodeticLatitudeToMercatorAngle(T),n=1/(z.geodeticLatitudeToMercatorAngle(N)-r));let k=i.subarray(0,o),x=i.subarray(o,2*o),G=i.subarray(2*o,3*o),M=w(s),F=new Array(o),W=new Array(o),v=new Array(o),H=h?new Array(o):[],O=d?new Array(o):[],j=Xt;j.x=Number.POSITIVE_INFINITY,j.y=Number.POSITIVE_INFINITY,j.z=Number.POSITIVE_INFINITY;let V=Zt;V.x=Number.NEGATIVE_INFINITY,V.y=Number.NEGATIVE_INFINITY,V.z=Number.NEGATIVE_INFINITY;let _=Number.POSITIVE_INFINITY,C=Number.NEGATIVE_INFINITY,R=Number.POSITIVE_INFINITY,B=Number.NEGATIVE_INFINITY;for(let w=0;w<o;++w){let t=k[w],e=x[w],i=t/ht,o=e/ht,s=f.lerp(E,S,G[w]/ht);u.longitude=f.lerp(I,g,i),u.latitude=f.lerp(T,N,o),u.height=s,_=Math.min(u.longitude,_),C=Math.max(u.longitude,C),R=Math.min(u.latitude,R),B=Math.max(u.latitude,B);let a=p.cartographicToCartesian(u);F[w]=new lt(i,o),W[w]=s,v[w]=a,h&&(H[w]=(z.geodeticLatitudeToMercatorAngle(u.latitude)-r)*n),d&&(O[w]=p.geodeticSurfaceNormal(a)),U.multiplyByPoint(b,a,D),P.minimumByComponent(D,j,j),P.maximumByComponent(D,V,V)}let L,Z=tt(t.westIndices,(function(t,e){return F[t].y-F[e].y})),Q=tt(t.eastIndices,(function(t,e){return F[e].y-F[t].y})),K=tt(t.southIndices,(function(t,e){return F[e].x-F[t].x})),q=tt(t.northIndices,(function(t,e){return F[t].x-F[e].x}));E<0&&(L=new Ct(p).computeHorizonCullingPointPossiblyUnderEllipsoid(y,v,E));let et=E;et=Math.min(et,J(t.westIndices,t.westSkirtHeight,W,F,m,p,b,j,V)),et=Math.min(et,J(t.southIndices,t.southSkirtHeight,W,F,m,p,b,j,V)),et=Math.min(et,J(t.eastIndices,t.eastSkirtHeight,W,F,m,p,b,j,V)),et=Math.min(et,J(t.northIndices,t.northSkirtHeight,W,F,m,p,b,j,V));let rt=new Wt(j,V,y),nt=new vt(y,rt,et,S,A,M,h,d,c,l),it=nt.stride,ot=o*it+a*it,st=new Float32Array(ot),at=0;for(let u=0;u<o;++u){if(M){let t=2*u;Y.x=s[t],Y.y=s[t+1]}at=nt.encode(st,at,v[u],F[u],W[u],Y,H[u],O[u])}let ut=Math.max(0,2*(a-4)),ct=t.indices.length+3*ut,dt=X.createTypedArray(o+a,ct);dt.set(t.indices,0);let mt=1e-4,It=(C-_)*mt,Tt=(B-R)*mt,gt=-It,ft=0,wt=It,Nt=0,Et=0,St=Tt,yt=0,kt=-Tt,Pt=o*it;return $(st,Pt,Z,nt,W,F,s,p,m,t.westSkirtHeight,r,n,gt,ft),Pt+=t.westIndices.length*it,$(st,Pt,K,nt,W,F,s,p,m,t.southSkirtHeight,r,n,yt,kt),Pt+=t.southIndices.length*it,$(st,Pt,Q,nt,W,F,s,p,m,t.eastSkirtHeight,r,n,wt,Nt),Pt+=t.eastIndices.length*it,$(st,Pt,q,nt,W,F,s,p,m,t.northSkirtHeight,r,n,Et,St),Vt.addSkirtIndices(Z,K,Q,q,o,dt,t.indices.length),e.push(st.buffer,dt.buffer),{vertices:st.buffer,indices:dt.buffer,westIndicesSouthToNorth:Z,southIndicesEastToWest:K,eastIndicesNorthToSouth:Q,northIndicesWestToEast:q,vertexStride:it,center:y,minimumHeight:E,maximumHeight:S,occludeePointInScaledSpace:L,encoding:nt,indexCountWithoutSkirts:t.indices.length}}function J(t,e,r,n,i,o,s,a,h){let c=Number.POSITIVE_INFINITY,l=i.north,d=i.south,m=i.east,I=i.west;m<I&&(m+=f.TWO_PI);let T=t.length;for(let g=0;g<T;++g){let i=t[g],T=r[i],w=n[i];u.longitude=f.lerp(I,m,w.x),u.latitude=f.lerp(d,l,w.y),u.height=T-e;let N=o.cartographicToCartesian(u,D);U.multiplyByPoint(s,N,N),P.minimumByComponent(N,a,a),P.maximumByComponent(N,h,h),c=Math.min(c,u.height)}return c}function $(t,e,r,n,i,o,s,a,h,c,l,d,m,I){let T=w(s),g=h.north,N=h.south,p=h.east,E=h.west;p<E&&(p+=f.TWO_PI);let S=r.length;for(let w=0;w<S;++w){let h=r[w],S=i[h],y=o[h];u.longitude=f.lerp(E,p,y.x)+m,u.latitude=f.lerp(N,g,y.y)+I,u.height=S-c;let A,b,k=a.cartographicToCartesian(u,D);if(T){let t=2*h;Y.x=s[t],Y.y=s[t+1]}n.hasWebMercatorT&&(A=(z.geodeticLatitudeToMercatorAngle(u.latitude)-l)*d),n.hasGeodeticSurfaceNormals&&(b=a.geodeticSurfaceNormal(k)),e=n.encode(t,e,k,y,u.height,Y,A,b)}}function tt(t,e){let r;return"function"==typeof t.slice&&(r=t.slice(),"function"!=typeof r.sort&&(r=void 0)),w(r)||(r=Array.prototype.slice.call(t)),r.sort(e),r}var Se=Mt(Jt);export{Se as default};